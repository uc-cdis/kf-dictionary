$schema: "http://json-schema.org/draft-04/schema#"

id: "diagnosis"
title: Diagnosis
type: object
namespace: https://dcf-interop.kidsfirstdrc.org/
category: clinical
program: '*'
project: '*'
description: >
  Data from the investigation, analysis and recognition of the presence and nature of disease,
  condition, or injury from expressed signs and symptoms; also, the scientific determination of any
  kind; the concise results of such an investigation.
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - state
  - created_datetime
  - updated_datetime

links:
  - name: participants
    backref: diagnoses
    label: describes
    target_type: participant
    multiplicity: many_to_one
    required: true

required:
  - submitter_id
  - participants
  - type

uniqueKeys:
  #unclear if want submitter ID for clinical
  - [id]
  - [project_id, submitter_id]

properties:
  $ref_ubiq: "_definitions.yaml#/ubiquitous_properties"

  external_id:
    description: "external id used by contributor"
    type: string

  diagnosis:
    description: |
      A calculated rollup of a participant’s diagnoses. If the participant has only Cancer diagnoses, the participant’s value is Cancer. If the participant has only Structural Birth Defect diagnoses, the value is Structural Birth Defects.
    type: string
    
  diagnosis_source_text:
    description: |
      Analysis, and recognition of the presence and nature of disease, condition, or injury from expressed signs and symptoms; also, the scientific determination of any kind; the concise results of such a study/investigation.
    type: string
    
  diagnosis_category:
    description: |
      An overarching classification based on the Diagnosis Source Text to aide in quick searching over Cancer and Structural Birth Defects.
    enum:
      - Structural Birth Defect
      - Cancer
      - Not Reported

  icd_id_diagnosis:
    description: |
      ICD10 code for the diagnosis.
    type: string

  mondo_id_diagnosis:
    description: |
      The Mondo ID associated with the Diagnosis (Source Text) value. Derived by matching the Diagnosis Source Text value with Mondo ID lookups.
    type: string
    
  ncit_id_diagnosis:
    description: |
      The National Cancer Institute Thesaurus (NCIt) ID associated with the Diagnosis (Source Text) value. Derived by matching the Diagnosis Source Text value with NCIt lookups.
    type: string

  spatial_descriptor:
    description: |
      Term to indicate precise, relative anatomical position from where the biospecimen was obtained.
    type: string

  tumor_location_source_text:
    description: |
      Text term from the investigator that describes the anatomic site of the tumor.
    type: string

  source_text_tumor_location:
    description: |
      TBD
    type: string

  uberon_id_tumor_location:
    description: |
      TBD
    type: string

  spatial_descriptor:
    description: |
      TBD
    type: string

  participants:
    $ref: "_definitions.yaml#/to_one"
